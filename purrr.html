<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R para jurimetria</title>
  <meta name="description" content="Template de relatório da ABJ.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R para jurimetria" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Template de relatório da ABJ." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R para jurimetria" />
  
  <meta name="twitter:description" content="Template de relatório da ABJ." />
  

<meta name="author" content="Associação Brasileira de Jurimetria">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="finalizando-analise-das-camaras-1.html">
<link rel="next" href="exemplo-formatando-arquivos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href='http://abj.org.br'><img src='https://raw.githubusercontent.com/abjur/tjspBook/master/abj_logo_cut.png' style="max-width:100%;"/></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Apresentação</a></li>
<li class="chapter" data-level="2" data-path="introducao.html"><a href="introducao.html"><i class="fa fa-check"></i><b>2</b> Introdução</a><ul>
<li class="chapter" data-level="2.1" data-path="o-que-e-jurimetria.html"><a href="o-que-e-jurimetria.html"><i class="fa fa-check"></i><b>2.1</b> O que é Jurimetria?</a></li>
<li class="chapter" data-level="2.2" data-path="tipos-de-estudo.html"><a href="tipos-de-estudo.html"><i class="fa fa-check"></i><b>2.2</b> Tipos de estudo</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tipos-de-estudo.html"><a href="tipos-de-estudo.html#exemplo"><i class="fa fa-check"></i><b>2.2.1</b> Exemplo</a></li>
<li class="chapter" data-level="2.2.2" data-path="tipos-de-estudo.html"><a href="tipos-de-estudo.html#divisao-regional"><i class="fa fa-check"></i><b>2.2.2</b> Divisão regional</a></li>
<li class="chapter" data-level="2.2.3" data-path="tipos-de-estudo.html"><a href="tipos-de-estudo.html#qual-tipo-escolher"><i class="fa fa-check"></i><b>2.2.3</b> Qual tipo escolher?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estudo-1-camaras-criminais.html"><a href="estudo-1-camaras-criminais.html"><i class="fa fa-check"></i><b>2.3</b> Estudo 1: Câmaras criminais</a></li>
<li class="chapter" data-level="2.4" data-path="estudo-2-especializacao-de-varas-empresariais.html"><a href="estudo-2-especializacao-de-varas-empresariais.html"><i class="fa fa-check"></i><b>2.4</b> Estudo 2: Especialização de varas empresariais</a><ul>
<li class="chapter" data-level="2.4.1" data-path="estudo-2-especializacao-de-varas-empresariais.html"><a href="estudo-2-especializacao-de-varas-empresariais.html#contextualizacao"><i class="fa fa-check"></i><b>2.4.1</b> Contextualização</a></li>
<li class="chapter" data-level="2.4.2" data-path="estudo-2-especializacao-de-varas-empresariais.html"><a href="estudo-2-especializacao-de-varas-empresariais.html#desafio-adicional-cifra-oculta"><i class="fa fa-check"></i><b>2.4.2</b> Desafio adicional: cifra oculta</a></li>
<li class="chapter" data-level="2.4.3" data-path="estudo-2-especializacao-de-varas-empresariais.html"><a href="estudo-2-especializacao-de-varas-empresariais.html#voltando-a-complexidade"><i class="fa fa-check"></i><b>2.4.3</b> Voltando à complexidade</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="estudo-3-captchas.html"><a href="estudo-3-captchas.html"><i class="fa fa-check"></i><b>2.5</b> Estudo 3: CAPTCHAs</a></li>
<li class="chapter" data-level="2.6" data-path="cuidado.html"><a href="cuidado.html"><i class="fa fa-check"></i><b>2.6</b> Cuidado</a></li>
<li class="chapter" data-level="2.7" data-path="organizacao-do-curso.html"><a href="organizacao-do-curso.html"><i class="fa fa-check"></i><b>2.7</b> Organização do curso</a></li>
<li class="chapter" data-level="2.8" data-path="configuracao-necessaria-para-o-curso.html"><a href="configuracao-necessaria-para-o-curso.html"><i class="fa fa-check"></i><b>2.8</b> Configuração necessária para o curso</a><ul>
<li class="chapter" data-level="2.8.1" data-path="configuracao-necessaria-para-o-curso.html"><a href="configuracao-necessaria-para-o-curso.html#pacotes"><i class="fa fa-check"></i><b>2.8.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.8.2" data-path="configuracao-necessaria-para-o-curso.html"><a href="configuracao-necessaria-para-o-curso.html#fork-e-upstream-experimental"><i class="fa fa-check"></i><b>2.8.2</b> Fork e upstream (experimental)</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="suas-tarefas-para-1701-demora-30-min.html"><a href="suas-tarefas-para-1701-demora-30-min.html"><i class="fa fa-check"></i><b>2.9</b> Suas tarefas para 17/01 (demora 30 min)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importacao-de-dados.html"><a href="importacao-de-dados.html"><i class="fa fa-check"></i><b>3</b> Importação de dados</a><ul>
<li class="chapter" data-level="3.0.1" data-path="importacao-de-dados.html"><a href="importacao-de-dados.html#setup"><i class="fa fa-check"></i><b>3.0.1</b> Setup</a></li>
<li class="chapter" data-level="3.1" data-path="pipe.html"><a href="pipe.html"><i class="fa fa-check"></i><b>3.1</b> Pipe <code>%&gt;%</code></a><ul>
<li class="chapter" data-level="3.1.1" data-path="pipe.html"><a href="pipe.html#receita-de-bolo"><i class="fa fa-check"></i><b>3.1.1</b> Receita de bolo</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="usando-o-inspect.html"><a href="usando-o-inspect.html"><i class="fa fa-check"></i><b>3.2</b> Usando o Inspect</a></li>
<li class="chapter" data-level="3.3" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html"><i class="fa fa-check"></i><b>3.3</b> Pacotes <code>httr</code>, <code>xml2</code> e <code>rvest</code></a><ul>
<li class="chapter" data-level="3.3.1" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html#get-e-post"><i class="fa fa-check"></i><b>3.3.1</b> <code>GET</code> e <code>POST</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html#exercicios"><i class="fa fa-check"></i><b>3.3.2</b> Exercícios</a></li>
<li class="chapter" data-level="3.3.3" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html#sessoes-e-cookies"><i class="fa fa-check"></i><b>3.3.3</b> Sessões e cookies</a></li>
<li class="chapter" data-level="3.3.4" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html#outras-funcoes-do-httr"><i class="fa fa-check"></i><b>3.3.4</b> Outras funções do <code>httr</code></a></li>
<li class="chapter" data-level="3.3.5" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html#principais-funcoes-do-rvest"><i class="fa fa-check"></i><b>3.3.5</b> Principais funções do <code>rvest</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="pacotes-httr-xml2-e-rvest.html"><a href="pacotes-httr-xml2-e-rvest.html#css-path-e-xpath"><i class="fa fa-check"></i><b>3.3.6</b> CSS path e XPath</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="melhores-praticas-para-web-scraping.html"><a href="melhores-praticas-para-web-scraping.html"><i class="fa fa-check"></i><b>3.4</b> Melhores práticas para web scraping</a><ul>
<li class="chapter" data-level="3.4.1" data-path="melhores-praticas-para-web-scraping.html"><a href="melhores-praticas-para-web-scraping.html#informacoes-iniciais"><i class="fa fa-check"></i><b>3.4.1</b> Informações iniciais</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="listando-processos.html"><a href="listando-processos.html"><i class="fa fa-check"></i><b>3.5</b> Listando processos</a></li>
<li class="chapter" data-level="3.6" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html"><i class="fa fa-check"></i><b>3.6</b> Usando o <code>esaj</code> para listar processos</a><ul>
<li class="chapter" data-level="3.6.1" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#pesquisa-por-palavras-chave"><i class="fa fa-check"></i><b>3.6.1</b> Pesquisa por palavras-chave</a></li>
<li class="chapter" data-level="3.6.2" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#pesquisa-por-datas"><i class="fa fa-check"></i><b>3.6.2</b> Pesquisa por datas</a></li>
<li class="chapter" data-level="3.6.3" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#tabelas-de-classes-assuntos-e-camaras"><i class="fa fa-check"></i><b>3.6.3</b> Tabelas de classes, assuntos e câmaras</a></li>
<li class="chapter" data-level="3.6.4" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#a-funcao-download_cjsg"><i class="fa fa-check"></i><b>3.6.4</b> A função <code>download_cjsg</code></a></li>
<li class="chapter" data-level="3.6.5" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#exercicios-1"><i class="fa fa-check"></i><b>3.6.5</b> Exercícios</a></li>
<li class="chapter" data-level="3.6.6" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#arrumando-os-dados"><i class="fa fa-check"></i><b>3.6.6</b> Arrumando os dados</a></li>
<li class="chapter" data-level="3.6.7" data-path="usando-o-esaj-para-listar-processos.html"><a href="usando-o-esaj-para-listar-processos.html#exercicios-2"><i class="fa fa-check"></i><b>3.6.7</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="usando-o-dje-para-listar-processos.html"><a href="usando-o-dje-para-listar-processos.html"><i class="fa fa-check"></i><b>3.7</b> Usando o <code>dje</code> para listar processos</a><ul>
<li class="chapter" data-level="3.7.1" data-path="usando-o-dje-para-listar-processos.html"><a href="usando-o-dje-para-listar-processos.html#exercicio"><i class="fa fa-check"></i><b>3.7.1</b> Exercício</a></li>
<li class="chapter" data-level="3.7.2" data-path="usando-o-dje-para-listar-processos.html"><a href="usando-o-dje-para-listar-processos.html#parse-dje"><i class="fa fa-check"></i><b>3.7.2</b> Parse DJE</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="baixando-documentos.html"><a href="baixando-documentos.html"><i class="fa fa-check"></i><b>3.8</b> Baixando documentos</a><ul>
<li class="chapter" data-level="3.8.1" data-path="baixando-documentos.html"><a href="baixando-documentos.html#download-cposg"><i class="fa fa-check"></i><b>3.8.1</b> Download CPOSG</a></li>
<li class="chapter" data-level="3.8.2" data-path="baixando-documentos.html"><a href="baixando-documentos.html#baixando-decisoes"><i class="fa fa-check"></i><b>3.8.2</b> Baixando decisões</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="processando-documentos.html"><a href="processando-documentos.html"><i class="fa fa-check"></i><b>3.9</b> Processando documentos</a><ul>
<li class="chapter" data-level="3.9.1" data-path="processando-documentos.html"><a href="processando-documentos.html#parse-cposg"><i class="fa fa-check"></i><b>3.9.1</b> Parse CPOSG</a></li>
<li class="chapter" data-level="3.9.2" data-path="processando-documentos.html"><a href="processando-documentos.html#exercicios-3"><i class="fa fa-check"></i><b>3.9.2</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="pacote-abjutils.html"><a href="pacote-abjutils.html"><i class="fa fa-check"></i><b>3.10</b> Pacote <code>abjutils</code></a><ul>
<li class="chapter" data-level="3.10.1" data-path="pacote-abjutils.html"><a href="pacote-abjutils.html#trabalhando-com-numeros-de-processos"><i class="fa fa-check"></i><b>3.10.1</b> Trabalhando com números de processos</a></li>
<li class="chapter" data-level="3.10.2" data-path="pacote-abjutils.html"><a href="pacote-abjutils.html#trabalhando-com-acentos"><i class="fa fa-check"></i><b>3.10.2</b> Trabalhando com acentos</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i><b>3.11</b> Wrap-up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="transformacao-de-dados-1.html"><a href="transformacao-de-dados-1.html"><i class="fa fa-check"></i><b>4</b> Transformação de dados 1</a><ul>
<li class="chapter" data-level="4.0.1" data-path="transformacao-de-dados-1.html"><a href="transformacao-de-dados-1.html#setup-1"><i class="fa fa-check"></i><b>4.0.1</b> Setup</a></li>
<li class="chapter" data-level="4.1" data-path="revisao.html"><a href="revisao.html"><i class="fa fa-check"></i><b>4.1</b> Revisão</a></li>
<li class="chapter" data-level="4.2" data-path="pacote-lubridate-para-datas.html"><a href="pacote-lubridate-para-datas.html"><i class="fa fa-check"></i><b>4.2</b> Pacote <code>lubridate</code> para datas</a><ul>
<li class="chapter" data-level="4.2.1" data-path="pacote-lubridate-para-datas.html"><a href="pacote-lubridate-para-datas.html#exercicios-4"><i class="fa fa-check"></i><b>4.2.1</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="pacote-stringr-para-trabalhar-com-textos.html"><a href="pacote-stringr-para-trabalhar-com-textos.html"><i class="fa fa-check"></i><b>4.3</b> Pacote <code>stringr</code> para trabalhar com textos</a><ul>
<li class="chapter" data-level="4.3.1" data-path="pacote-stringr-para-trabalhar-com-textos.html"><a href="pacote-stringr-para-trabalhar-com-textos.html#regras-basicas"><i class="fa fa-check"></i><b>4.3.1</b> Regras básicas</a></li>
<li class="chapter" data-level="4.3.2" data-path="pacote-stringr-para-trabalhar-com-textos.html"><a href="pacote-stringr-para-trabalhar-com-textos.html#funcoes-do-stringr"><i class="fa fa-check"></i><b>4.3.2</b> Funções do <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="expressoes-regulares.html"><a href="expressoes-regulares.html"><i class="fa fa-check"></i><b>4.4</b> Expressões regulares</a><ul>
<li class="chapter" data-level="4.4.1" data-path="expressoes-regulares.html"><a href="expressoes-regulares.html#quantificadores"><i class="fa fa-check"></i><b>4.4.1</b> Quantificadores</a></li>
<li class="chapter" data-level="4.4.2" data-path="expressoes-regulares.html"><a href="expressoes-regulares.html#conjuntos"><i class="fa fa-check"></i><b>4.4.2</b> Conjuntos</a></li>
<li class="chapter" data-level="4.4.3" data-path="expressoes-regulares.html"><a href="expressoes-regulares.html#miscelanea"><i class="fa fa-check"></i><b>4.4.3</b> Miscelânea</a></li>
<li class="chapter" data-level="4.4.4" data-path="expressoes-regulares.html"><a href="expressoes-regulares.html#outros-links"><i class="fa fa-check"></i><b>4.4.4</b> Outros links</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="exemplo-decisoes-das-camaras.html"><a href="exemplo-decisoes-das-camaras.html"><i class="fa fa-check"></i><b>4.5</b> Exemplo: decisões das câmaras</a></li>
<li class="chapter" data-level="4.6" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html"><i class="fa fa-check"></i><b>4.6</b> Pacotes <code>dplyr</code> e <code>tidyr</code></a><ul>
<li class="chapter" data-level="4.6.1" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#caracteristicas-do-dplyr"><i class="fa fa-check"></i><b>4.6.1</b> Características do <code>dplyr</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#as-cinco-funcoes-principais"><i class="fa fa-check"></i><b>4.6.2</b> As cinco funções principais</a></li>
<li class="chapter" data-level="4.6.3" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#select"><i class="fa fa-check"></i><b>4.6.3</b> <code>select</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#filter"><i class="fa fa-check"></i><b>4.6.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#mutate"><i class="fa fa-check"></i><b>4.6.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#arrange"><i class="fa fa-check"></i><b>4.6.6</b> <code>arrange</code></a></li>
<li class="chapter" data-level="4.6.7" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#summarise"><i class="fa fa-check"></i><b>4.6.7</b> <code>summarise</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#gather"><i class="fa fa-check"></i><b>4.6.8</b> <code>gather</code></a></li>
<li class="chapter" data-level="4.6.9" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#spread"><i class="fa fa-check"></i><b>4.6.9</b> <code>spread</code></a></li>
<li class="chapter" data-level="4.6.10" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#funcoes-auxiliares"><i class="fa fa-check"></i><b>4.6.10</b> Funções auxiliares</a></li>
<li class="chapter" data-level="4.6.11" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#nest-e-unnest"><i class="fa fa-check"></i><b>4.6.11</b> <code>nest</code> e <code>unnest</code></a></li>
<li class="chapter" data-level="4.6.12" data-path="pacotes-dplyr-e-tidyr.html"><a href="pacotes-dplyr-e-tidyr.html#um-pouco-mais-de-transformacao-de-dados"><i class="fa fa-check"></i><b>4.6.12</b> Um pouco mais de transformação de dados</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="finalizando-analise-das-camaras.html"><a href="finalizando-analise-das-camaras.html"><i class="fa fa-check"></i><b>4.7</b> Finalizando análise das câmaras</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transformacao-de-dados-2.html"><a href="transformacao-de-dados-2.html"><i class="fa fa-check"></i><b>5</b> Transformação de dados 2</a><ul>
<li class="chapter" data-level="5.0.1" data-path="transformacao-de-dados-2.html"><a href="transformacao-de-dados-2.html#na-ultima-vez"><i class="fa fa-check"></i><b>5.0.1</b> Na última vez</a></li>
<li class="chapter" data-level="5.0.2" data-path="transformacao-de-dados-2.html"><a href="transformacao-de-dados-2.html#setup-2"><i class="fa fa-check"></i><b>5.0.2</b> Setup</a></li>
<li class="chapter" data-level="5.1" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html"><i class="fa fa-check"></i><b>5.1</b> Funções do <code>tidyr</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html#gather-1"><i class="fa fa-check"></i><b>5.1.1</b> <code>gather</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html#spread-1"><i class="fa fa-check"></i><b>5.1.2</b> <code>spread</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html#unindo-e-separando-colunas"><i class="fa fa-check"></i><b>5.1.3</b> Unindo e separando colunas</a></li>
<li class="chapter" data-level="5.1.4" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html#list-columns-nest-e-unnest"><i class="fa fa-check"></i><b>5.1.4</b> List columns: <code>nest</code> e <code>unnest</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html#joins"><i class="fa fa-check"></i><b>5.1.5</b> Joins</a></li>
<li class="chapter" data-level="5.1.6" data-path="funcoes-do-tidyr.html"><a href="funcoes-do-tidyr.html#duplicatas"><i class="fa fa-check"></i><b>5.1.6</b> Duplicatas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="finalizando-analise-das-camaras-1.html"><a href="finalizando-analise-das-camaras-1.html"><i class="fa fa-check"></i><b>5.2</b> Finalizando análise das câmaras</a><ul>
<li class="chapter" data-level="5.2.1" data-path="finalizando-analise-das-camaras-1.html"><a href="finalizando-analise-das-camaras-1.html#como-se-distribuem-os-assuntos-em-cada-camara"><i class="fa fa-check"></i><b>5.2.1</b> Como se distribuem os assuntos em cada câmara?</a></li>
<li class="chapter" data-level="5.2.2" data-path="finalizando-analise-das-camaras-1.html"><a href="finalizando-analise-das-camaras-1.html#quantas-decisoes-proferidas-por-semana"><i class="fa fa-check"></i><b>5.2.2</b> Quantas decisões proferidas por semana?</a></li>
<li class="chapter" data-level="5.2.3" data-path="finalizando-analise-das-camaras-1.html"><a href="finalizando-analise-das-camaras-1.html#qual-a-proporcao-de-decisoes-por-camara"><i class="fa fa-check"></i><b>5.2.3</b> Qual a proporção de decisões por câmara?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="purrr.html"><a href="purrr.html"><i class="fa fa-check"></i><b>5.3</b> purrr</a><ul>
<li class="chapter" data-level="5.3.1" data-path="purrr.html"><a href="purrr.html#iteracoes-basicas"><i class="fa fa-check"></i><b>5.3.1</b> Iterações básicas</a></li>
<li class="chapter" data-level="5.3.2" data-path="purrr.html"><a href="purrr.html#iteracoes-intermediarias"><i class="fa fa-check"></i><b>5.3.2</b> Iterações intermediárias</a></li>
<li class="chapter" data-level="5.3.3" data-path="purrr.html"><a href="purrr.html#iteracoes-avancadas"><i class="fa fa-check"></i><b>5.3.3</b> Iterações avançadas</a></li>
<li class="chapter" data-level="5.3.4" data-path="purrr.html"><a href="purrr.html#reducao-e-acumulo"><i class="fa fa-check"></i><b>5.3.4</b> Redução e acúmulo</a></li>
<li class="chapter" data-level="5.3.5" data-path="purrr.html"><a href="purrr.html#miscelanea-1"><i class="fa fa-check"></i><b>5.3.5</b> Miscelânea</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="exemplo-formatando-arquivos.html"><a href="exemplo-formatando-arquivos.html"><i class="fa fa-check"></i><b>5.4</b> Exemplo: formatando arquivos</a></li>
<li class="chapter" data-level="5.5" data-path="calculando-tempos-e-intervalos-de-tempo.html"><a href="calculando-tempos-e-intervalos-de-tempo.html"><i class="fa fa-check"></i><b>5.5</b> Calculando tempos e intervalos de tempo</a><ul>
<li class="chapter" data-level="5.5.1" data-path="calculando-tempos-e-intervalos-de-tempo.html"><a href="calculando-tempos-e-intervalos-de-tempo.html#estatisticas-de-movimentacoes"><i class="fa fa-check"></i><b>5.5.1</b> estatísticas de movimentações</a></li>
<li class="chapter" data-level="5.5.2" data-path="calculando-tempos-e-intervalos-de-tempo.html"><a href="calculando-tempos-e-intervalos-de-tempo.html#calculando-intervalos-de-tempo"><i class="fa fa-check"></i><b>5.5.2</b> Calculando intervalos de tempo</a></li>
<li class="chapter" data-level="5.5.3" data-path="calculando-tempos-e-intervalos-de-tempo.html"><a href="calculando-tempos-e-intervalos-de-tempo.html#resultados"><i class="fa fa-check"></i><b>5.5.3</b> Resultados</a></li>
<li class="chapter" data-level="5.5.4" data-path="calculando-tempos-e-intervalos-de-tempo.html"><a href="calculando-tempos-e-intervalos-de-tempo.html#wrap-up-de-hoje"><i class="fa fa-check"></i><b>5.5.4</b> Wrap-up de hoje</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="work-in-progress.html"><a href="work-in-progress.html"><i class="fa fa-check"></i><b>6</b> Work in progress</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R para jurimetria</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="purrr" class="section level2">
<h2><span class="header-section-number">5.3</span> purrr</h2>
<p>Ao usar programação funcional (PF) podemos criar códigos concisos e “pipeáveis”, que tornam o código mais legível e o processo de debug mais simples. Além disso, códigos funcionais geralmente são paralelizáveis, permitindo que tratemos problemas grandes com poucas modificações.</p>
<p>Apesar de o R <code>base</code> já ter funções que podem ser consideradas elementos de PF, a implementação destas não é elegante. Este tutorial abordará a implementação de PF realizada pelo pacote <code>purrr</code>.</p>
<p><strong>Cuidado</strong>: material altamente viciante.</p>
<p><img src="imgs/izbicki.jpg" width="256" /></p>
<div id="iteracoes-basicas" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Iterações básicas</h3>
<p>As funções <code>map()</code> são quase como substitutas para laços <code>for</code>: elas abstraem a iteração em apenas uma linha. Veja esse exemplo de laço usando <code>for</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_um &lt;-<span class="st"> </span>function(x) x +<span class="st"> </span><span class="dv">1</span>
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

for (i in <span class="kw">seq_along</span>(obj)) {
  obj[i] &lt;-<span class="st"> </span><span class="kw">soma_um</span>(obj[i])
}
obj</code></pre></div>
<pre><code>#&gt; [1] 11 12 13 14 15 16</code></pre>
<p>O que de fato estamos tentando fazer com o laço acima? Temos um vetor (<code>obj</code>) e queremos aplicar uma função (<code>soma_um()</code>) em cada elemento dele. A função <code>map()</code> remove a necessidade de declaramos um objeto iterador auxiliar (<code>i</code>) e simplesmente aplica a função desejada em cada elemento do objeto dado.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_um &lt;-<span class="st"> </span>function(x) x +<span class="st"> </span><span class="dv">1</span>
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

obj &lt;-<span class="st"> </span><span class="kw">map</span>(obj, soma_um)
obj</code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; [1] 11
#&gt; 
#&gt; [[2]]
#&gt; [1] 12
#&gt; 
#&gt; [[3]]
#&gt; [1] 13
#&gt; 
#&gt; [[4]]
#&gt; [1] 14
#&gt; 
#&gt; [[5]]
#&gt; [1] 15
#&gt; 
#&gt; [[6]]
#&gt; [1] 16</code></pre>
<div id="achatando-resultados" class="section level4">
<h4><span class="header-section-number">5.3.1.1</span> Achatando resultados</h4>
<p>Se quisermos “achatar” o resultado, devemos informar qual será o seu tipo. Isso pode ser feito com as irmãs da <code>map()</code>: <code>map_chr()</code> (para strings), <code>map_dbl()</code> (para números reais), <code>map_int()</code> (para números inteiros) e <code>map_lgl()</code> (para booleanos).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">map_dbl</span>(obj, soma_um)</code></pre></div>
<pre><code>#&gt; [1] 11 12 13 14 15 16</code></pre>
<p>O <code>purrr</code> também nos fornece outra ferramenta interessante para achatar listas: a família <code>flatten()</code>. <code>map_chr()</code> é um atalho para <code>map() %&gt;% flatten_chr()</code>.</p>
<p>O achatamento não precisa necessariamente virar um atômico. Duas funções muito utilizadas da família <code>map()</code> são <code>map_dfc()</code> e <code>map_dfr()</code>, que equivalem a um <code>map()</code> seguido de um <code>dplyr::bind_cols()</code> ou de um <code>dplyr::bind_rows()</code> respectivamente.</p>
<p><code>walk()</code> é uma versão do <code>map()</code> que não retorna nada nas iterações. Ela serve para fazer efeitos colaterais, como salvar arquivos e imprimir coisas na tela.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(<span class="dv">1</span>:<span class="dv">2</span>, print)</code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; [1] 2</code></pre>
<pre><code>#&gt; [[1]]
#&gt; [1] 1
#&gt; 
#&gt; [[2]]
#&gt; [1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">walk</span>(<span class="dv">1</span>:<span class="dv">2</span>, print)</code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; [1] 2</code></pre>
</div>
<div id="formulas-e-reticencias" class="section level4">
<h4><span class="header-section-number">5.3.1.2</span> Fórmulas e reticências</h4>
<p>Algo bastante útil da família <code>map()</code> é a possibilidade de passar argumentos fixos para a função que será aplicada. A primeira forma de fazer isso envolve fórmulas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_n &lt;-<span class="st"> </span>function(x, <span class="dt">n =</span> <span class="dv">1</span>) x +<span class="st"> </span>n
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">map_dbl</span>(obj, ~<span class="kw">soma_n</span>(.x, <span class="dv">2</span>))</code></pre></div>
<pre><code>#&gt; [1] 12 13 14 15 16 17</code></pre>
<p>Precisamos colocar um til (<code>~</code>) antes da função que será chamada. Feito isso, podemos utilizar o placeholder <code>.x</code> para indicar onde deve ser colocado cada elemento de <code>obj</code>.</p>
<p>A outra forma de passar argumentos para a função é através das reticências de <code>map()</code>. Desta maneira precisamos apenas dar o nome do argumento e seu valor logo após a função <code>soma_n()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_n &lt;-<span class="st"> </span>function(x, <span class="dt">n =</span> <span class="dv">1</span>) x +<span class="st"> </span>n
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">map_dbl</span>(obj, soma_n, <span class="dt">n =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>#&gt; [1] 12 13 14 15 16 17</code></pre>
</div>
</div>
<div id="iteracoes-intermediarias" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Iterações intermediárias</h3>
<p>Agora que já exploramos os básicos da família <code>map()</code> podemos partir para iterações um pouco mais complexas. Observe o laço a seguir:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_ambos &lt;-<span class="st"> </span>function(x, y) x +<span class="st"> </span>y
obj_1 &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>
obj_2 &lt;-<span class="st"> </span><span class="dv">20</span>:<span class="dv">25</span>

for (i in <span class="kw">seq_along</span>(obj_1)) {
  obj_1[i] &lt;-<span class="st"> </span><span class="kw">soma_ambos</span>(obj_1[i], obj_2[i])
}
obj_1</code></pre></div>
<pre><code>#&gt; [1] 30 32 34 36 38 40</code></pre>
<p>Com a função <code>map2()</code> podemos reproduzir o laço acima em apenas uma linha. Ela abstrai a iteração em paralelo, aplica a função em cada par de elementos das entradas e, assim como sua prima <code>map()</code>, pode achatar o objeto retornado com os sufixos <code>_chr</code>, <code>_dbl</code>, <code>_int</code> e <code>_lgl</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_ambos &lt;-<span class="st"> </span>function(x, y) x +<span class="st"> </span>y
obj_1 &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>
obj_2 &lt;-<span class="st"> </span><span class="dv">20</span>:<span class="dv">25</span>

obj_1 &lt;-<span class="st"> </span><span class="kw">map2_dbl</span>(obj_1, obj_2, soma_ambos)
obj_1</code></pre></div>
<pre><code>#&gt; [1] 30 32 34 36 38 40</code></pre>
<p>Como o pacote <code>purrr</code> é extremamente consistente, a <code>map2()</code> também funciona com reticências e fórmulas. Poderíamos, por exemplo, transformar <code>soma_ambos()</code> em uma função anônima:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj_1 &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>
obj_2 &lt;-<span class="st"> </span><span class="dv">20</span>:<span class="dv">25</span>

<span class="kw">map2_dbl</span>(obj_1, obj_2, ~.x +<span class="st"> </span>.y)</code></pre></div>
<pre><code>#&gt; [1] 30 32 34 36 38 40</code></pre>
<p>Desta vez também temos acesso ao placeholder <code>.y</code> para indicar onde os elementos de do segundo vetor devem ir.</p>
<div id="generalizacao" class="section level4">
<h4><span class="header-section-number">5.3.2.1</span> Generalização</h4>
<p>Para não precisar oferecer uma função para cada número de argumentos, o pacote <code>purrr</code> fornece a <code>pmap()</code>. Para essa função devemos passar uma lista em que cada elemento é um dos objetos a ser iterado:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_varios &lt;-<span class="st"> </span>function(x, y, z) x +<span class="st"> </span>y +<span class="st"> </span>z
obj_1 &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>
obj_2 &lt;-<span class="st"> </span><span class="dv">20</span>:<span class="dv">25</span>
obj_3 &lt;-<span class="st"> </span><span class="dv">30</span>:<span class="dv">35</span>

obj_1 &lt;-<span class="st"> </span><span class="kw">pmap_dbl</span>(<span class="kw">list</span>(obj_1, obj_2, obj_3), soma_varios)
obj_1</code></pre></div>
<pre><code>#&gt; [1] 60 63 66 69 72 75</code></pre>
<p>Com a <code>pmap()</code> não podemos usar fórmulas. Se quisermos usar uma função anônima com ela, precisamos declará-la a função no seu corpo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj_1 &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>
obj_2 &lt;-<span class="st"> </span><span class="dv">20</span>:<span class="dv">25</span>
obj_3 &lt;-<span class="st"> </span><span class="dv">30</span>:<span class="dv">35</span>

<span class="kw">pmap_dbl</span>(<span class="kw">list</span>(obj_1, obj_2, obj_3), function(x, y, z) { x +<span class="st"> </span>y +<span class="st"> </span>z })</code></pre></div>
<pre><code>#&gt; [1] 60 63 66 69 72 75</code></pre>
</div>
<div id="iterando-em-indices" class="section level4">
<h4><span class="header-section-number">5.3.2.2</span> Iterando em índices</h4>
<p><code>imap()</code> é um atalho para <code>map2(x, names(x), ...)</code> quando <code>x</code> tem nomes e para <code>map2(x, seq_along(x), ...)</code> caso contrário:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">imap_chr</span>(obj, ~<span class="kw">paste</span>(.x, .y, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>))</code></pre></div>
<pre><code>#&gt; [1] &quot;10/1&quot; &quot;11/2&quot; &quot;12/3&quot; &quot;13/4&quot; &quot;14/5&quot; &quot;15/6&quot;</code></pre>
<p>Naturalmente, assim como toda a família <code>map()</code>, a <code>imap()</code> também funciona com os sufixos de achatamento.</p>
</div>
</div>
<div id="iteracoes-avancadas" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Iterações avançadas</h3>
<p>Agora vamos passar para os tipos mais obscuros de laços. Cada item desta seção será mais denso do que os das passadas, por isso encorajamos todos os leitores para que também leiam a documentação de cada função aqui abordada.</p>
<div id="iteracoes-com-condicionais" class="section level4">
<h4><span class="header-section-number">5.3.3.1</span> Iterações com condicionais</h4>
<p>Imagine que precisamos aplicar uma função somente em alguns elementos de um vetor. Veja o trecho de código a seguir por exemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dobra &lt;-<span class="st"> </span>function(x) x *<span class="st"> </span><span class="dv">2</span>
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

for (i in <span class="kw">seq_along</span>(obj)) {
  if (obj[i] %%<span class="st"> </span><span class="dv">2</span> ==<span class="st"> </span><span class="dv">1</span>) { 
    obj[i] &lt;-<span class="st"> </span><span class="kw">dobra</span>(obj[i]) 
  } else { 
    obj[i] &lt;-<span class="st"> </span>obj[i] 
  }
}
obj</code></pre></div>
<pre><code>#&gt; [1] 10 22 12 26 14 30</code></pre>
<p>Aplicamos a função <code>dobra()</code> apenas nos elementos ímpares do vetor <code>obj</code>. Com o pacote <code>purrr</code> temos duas maneiras de fazer isso: com <code>map_if()</code> ou <code>map_at()</code>.</p>
<p>A primeira dessas funções aplica a função dada apenas quando um predicado é <code>TRUE</code>. Esse predicado pode ser uma função ou uma fórmula.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eh_impar &lt;-<span class="st"> </span>function(x) x %%<span class="st"> </span><span class="dv">2</span> ==<span class="st"> </span><span class="dv">1</span>
dobra &lt;-<span class="st"> </span>function(x) x *<span class="st"> </span><span class="dv">2</span>
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">map_if</span>(obj, eh_impar, dobra) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">flatten_dbl</span>()</code></pre></div>
<pre><code>#&gt; [1] 10 22 12 26 14 30</code></pre>
<p>Com fórmulas poderíamos eliminar completamente a necessidade de funções declaradas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">map_if</span>(obj, ~.x %%<span class="st"> </span><span class="dv">2</span> ==<span class="st"> </span><span class="dv">1</span>, ~.x *<span class="st"> </span><span class="dv">2</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">flatten_dbl</span>()</code></pre></div>
<pre><code>#&gt; [1] 10 22 12 26 14 30</code></pre>
<p>Para <code>map_at()</code> devemos passar um vetor de nomes ou índices onde a função deve ser aplicada:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">map_at</span>(obj, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>), ~.x *<span class="st"> </span><span class="dv">2</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">flatten_dbl</span>()</code></pre></div>
<pre><code>#&gt; [1] 10 22 12 26 14 30</code></pre>
</div>
</div>
<div id="reducao-e-acumulo" class="section level3">
<h3><span class="header-section-number">5.3.4</span> Redução e acúmulo</h3>
<p>Outras funções simbólicas de programação funcional além da <code>map()</code> são <code>reduce()</code> e <code>accumulate()</code>, que aplicam transformações em valores acumulados. Observe o laço a seguir:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_ambos &lt;-<span class="st"> </span>function(x, y) x +<span class="st"> </span>y
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

for (i in <span class="dv">2</span>:<span class="kw">length</span>(obj)) {
  obj[i] &lt;-<span class="st"> </span><span class="kw">soma_ambos</span>(obj[i<span class="dv">-1</span>], obj[i])
}
obj</code></pre></div>
<pre><code>#&gt; [1] 10 21 33 46 60 75</code></pre>
<p>Observe como isso ficaria usando <code>accumulate()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_ambos &lt;-<span class="st"> </span>function(x, y) { x +<span class="st"> </span>y }
obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>

<span class="kw">accumulate</span>(obj, soma_ambos)</code></pre></div>
<pre><code>#&gt; [1] 10 21 33 46 60 75</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">accumulate</span>(obj, ~.x +<span class="st"> </span>.y)</code></pre></div>
<pre><code>#&gt; [1] 10 21 33 46 60 75</code></pre>
<p><strong>Obs.:</strong> Aqui, <code>.x</code> é o valor acumulado e <code>.y</code> é o valor “atual” do objeto sendo iterado.</p>
<p>Se não quisermos o valor acumulado em cada passo da iteração, podemos usar <code>reduce()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="dv">10</span>:<span class="dv">15</span>
<span class="kw">reduce</span>(obj, ~.x+.y)</code></pre></div>
<pre><code>#&gt; [1] 75</code></pre>
<p>Para a nossa comodidade, essas duas funções também têm variedades paralelas (<code>accumulate2()</code> e <code>reduce2()</code>), assim como variedades invertidas <code>accumulate_right()</code> e <code>reduce_right()</code>).</p>
</div>
<div id="miscelanea-1" class="section level3">
<h3><span class="header-section-number">5.3.5</span> Miscelânea</h3>
<div id="transposicao-e-indexacao-profunda" class="section level4">
<h4><span class="header-section-number">5.3.5.1</span> Transposição e indexação profunda</h4>
<p>Quando precisarmos lidar com listas complexas e profundas, o <code>purrr</code> nos fornece duas funções extremamente úteis: <code>transpose()</code> e <code>pluck()</code>. A primeira transpõe uma lista, enquanto a segunda é capaz de acessar elementos profundos de uma lista sem a necessidade de colchetes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obj &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">c =</span> <span class="dv">3</span>), 
  <span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">5</span>, <span class="dt">c =</span> <span class="dv">6</span>)
)
<span class="kw">pluck</span>(obj, <span class="dv">2</span>, <span class="st">&quot;b&quot;</span>)</code></pre></div>
<pre><code>#&gt; [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">transpose</span>(obj))</code></pre></div>
<pre><code>#&gt; List of 3
#&gt;  $ a:List of 2
#&gt;   ..$ : num 1
#&gt;   ..$ : num 4
#&gt;  $ b:List of 2
#&gt;   ..$ : num 2
#&gt;   ..$ : num 5
#&gt;  $ c:List of 2
#&gt;   ..$ : num 3
#&gt;   ..$ : num 6</code></pre>
<p><strong>Obs.:</strong> Se você estiver com muitos problemas com listas profundas, dê uma olhada nas funções relacionadas a <code>depth()</code> pois elas podem ser muito úteis.</p>
</div>
<div id="aplicacao-parcial" class="section level4">
<h4><span class="header-section-number">5.3.5.2</span> Aplicação parcial</h4>
<p>Se quisermos pré-preencher os argumentos de uma função (seja para usá-la em uma pipeline ou com alguma função do próprio <code>purrr</code>), temos <code>partial()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_varios &lt;-<span class="st"> </span>function(x, y, z) x +<span class="st"> </span>y +<span class="st"> </span>z
nova_soma &lt;-<span class="st"> </span><span class="kw">partial</span>(soma_varios, <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">2</span>)
<span class="kw">nova_soma</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>#&gt; [1] 6</code></pre>
</div>
<div id="execucao-segura" class="section level4">
<h4><span class="header-section-number">5.3.5.3</span> Execução segura</h4>
<p>Usar <code>tryCatch()</code> e <code>try()</code> no R sempre foi uma dor de cabeça enorme. O <code>purrr</code> resolve esse problema de maneira elegante e eficaz.</p>
<p><code>quietly()</code> retorna uma lista com resultado, saída, mensagem e alertas, <code>safely()</code> retorna uma lista com resultado e erro (um destes sempre é <code>NULL</code>), e <code>possibly()</code> silencia o erro e retorna um valor dado pelo usuário.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">soma_um &lt;-<span class="st"> </span>function(x) { x +<span class="st"> </span><span class="dv">1</span> }
s_soma_um &lt;-<span class="st"> </span><span class="kw">safely</span>(soma_um, <span class="dv">0</span>)
obj &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="st">&quot;a&quot;</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>)

<span class="kw">s_soma_um</span>(obj)</code></pre></div>
<pre><code>#&gt; $result
#&gt; [1] 0
#&gt; 
#&gt; $error
#&gt; &lt;simpleError in x + 1: non-numeric argument to binary operator&gt;</code></pre>
<p>É interessante notar que essas funções são advérbios, pois modificam as funções principais, que geralmente são verbos.</p>
<p>Se quiser ler mais sobre chamadas seguras, veja <a href="http://curso-r.com/blog/2017/04/20/2017-04-09-try/">o texto desse blog</a></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="finalizando-analise-das-camaras-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exemplo-formatando-arquivos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/04-transform.Rmd",
"text": "Edit"
},
"download": ["bookdown.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
